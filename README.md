
## Введение
Pet-проект, созданный для общественных нужд. Небольшой шаг в борьбе безысходностью и производственной рутиной, бессмысленной и беспощадной

## Описание
Шаблонизатор подготовки документов и реестров. В качестве источника данных используется Google App Script (GAS).<br>
Представлен в виде простого web-сервиса

## Назначение
Подготовка документов типа:
1. судебный приказ (docx) 
2. судебный иск (docx)
3. взыскание (docx)
4. почтовый реестр (xls)
5. текстовый реестр Сбера (txt)

## Требования
* PHP ^8.0

## Зависимости
composer:

    "wapmorgan/morphos": "^3.2",
    "phpoffice/phpword": "^1.2",
    "phpoffice/phpspreadsheet": "^1.23",
    "dompdf/dompdf": "^2.0",

Развёрнутое web-приложение как источник данных (GAS)

## Конфигурация
Core/env.example.php -> Core/env.php

## Каталог шаблонов
templates/

## Каталог временных файлов
online_tmp/

## Принцип работы
1. классификация документа по входным параметрам;
2. верификация типа и параметров документа;
3. создание сущности документа;
4. получение данных от поставщика;
5. верификация данных поставщика;
6. подготовка набора данных для шаблона документа;
7. создание документа из шаблона;
8. сохранение документа в каталог временных файлов;
9. передача документа 

## Входные данные
1. код портфеля (portfolio);
2. тип документа (docType);
3. цель документа (target)

#### Портфель
Портфель - набор исходных данных.<br>
Провайдер - поставщик данных. <br>
Код портфеля идентифицирует отвечающего за этот портфель поставщика данных провайдера

#### Тип документа
Тип документа - идентификатор из установленного набора документов (DOC_TYPES), на основании которого происходит подготовка документа

#### Цель документа
Цель документа - идентификатор, однозначно определяющий объект документа. <br>
Идентификаторами являются:
1. номер договора -- для docx-документов;
2. смешанный диапазон номеров строк -- для xls/txt-документов

Смешанный целевой диапазон может содержать строки вида "1","1,2,3","1-2,3","". Пустой диапазон подразумевает полную выборку 

За идентификацию документов первого типа отвечает источник данных.<br>
За идентификацию второго - провайдер.<br>

## Провайдер
Модель использования поставщика данных - Google App Script - приводится в качестве примера, и являлась частью базового проекта. 
Развёрнутое на её основе web-приложение принимает POST-запросом тип и цель документа; в качестве результата возвращает массив из одного или более ассоциативных наборов параметров. Реализация опускается

## Примеры использования
В качестве сервиса: <br>
>https://example.com/index.php?portfolio=viva1&docType=isk&target=Z010944176002

В качестве исполняемых скриптов: <br>
./scripts/googleIsk.php

Примеры результатов: <br>
examples/

## Заключение
Может быть использован в личных и корпоративных нуждах